<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>TinyRedis - Redis driver for the D programming language</title>

    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/pygment_trac.css">
    <script src="scripts/scale.fix.js"></script>
    
	<!-- Syntax Highlighter : http://softwaremaniacs.org/soft/highlight/en/download/ -->
	<link rel="stylesheet" href="styles/pojoaque.css">
	<script src="scripts/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">TinyRedis</h1>
        <p class="header">Fast, Simple, Unit Tested. Redis driver for <a href="http://www.dlang.org">D</a></p>
        <p>Latest Version : v2.1.0</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/adilbaig/Tiny-Redis/releases">All platforms - Source, examples, benchmark</a></li>
          <li><a class="buttons github" href="https://github.com/adilbaig/Tiny-Redis">View On GitHub</a></li>
        </ul>
		<iframe src="http://ghbtns.com/github-btn.html?user=adilbaig&repo=Tiny-Redis&type=watch&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="190px" height="35px" ></iframe>
		<iframe src="http://ghbtns.com/github-btn.html?user=adilbaig&repo=Tiny-Redis&type=fork&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="30px"></iframe>
		<iframe src="http://ghbtns.com/github-btn.html?user=adilbaig&repo=Tiny-Redis&type=follow&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="30px"></iframe>
        <p>By <a class="name" href="https://github.com/adilbaig">Adil Baig</a></p>
      </header>
      <section>
        <h1>Introduction</h1>

<p>TinyRedis is a Redis driver for the <a href="http://www.dlang.org">D programming language</a>. It is intentionally minimal, fast, simple, intuitive, clean, unit tested, forward compatible, has no dependencies and makes working with Redis trivial.</p>
<p>It supports all of Redis's data types; <a href="http://redis.io/commands#generic">keys</a>, 
<a href="http://redis.io/commands#hash">hashes</a>,
<a href="http://redis.io/commands#list">lists</a>, 
<a href="http://redis.io/commands#set">sets</a> etc. 
There's also support for :
</p>
 
<ul>
<li><a href="http://redis.io/commands/eval">Lua scripting</a></li>
<li><a href="http://redis.io/topics/pipelining">pipelining</a></li>
<li><a href="http://redis.io/topics/transactions">transactions</a></li>
<li><a href="http://redis.io/topics/pubsub">PubSub</a></li>
<li>and some OOP wrappers</li>
</ul>

<h2>TinyRedis is ..</h2>

<h4>intentionally minimal</h4>
<p>With TinyRedis you leverage your knowledge of Redis commands transparently. This minimizes the ramp-up time from learning the library to writing your application specific code. It's also simpler to build libraries on top of it.</p>

<h4>fast</h4>
<p>simple local benchmarking suggests TinyRedis can do 40k+ GETs/second. With pipelining the numbers are orders of magnitudes higher. In practice, TinyRedis is fast enough to handle most real-world volumes. Watch the benchmarking space below.</p>

<h4>simple</h4>
<p>Run any Redis command using one simple call : </p>
<pre><code>Response response = redis.send(string)</code></pre>
<p>That's it. All the other features reduce (more or less) boiler-plate from your code.</p>

<h4>intuitive</h4>
<p>By leveraging D's <a href="https://dlang.org/spec/operatoroverloading.html">magic operator overloading functions</a>, TinyRedis aims to do what you expect.</p>

<h4>clean</h4>
<p>The encoder is separate from the parser, which is separate from the driver. In theory, we can mix and match and possibly introduce more backends easily.</p>

<h4>unit tested</h4>
<p>The parser and the driver have unit tests that ship with source.</p>

<h4>forward compatible</h4>
<p>Due to TinyRedis' minimalist approach, any new commands introduced by Redis can be queried using the same API (as long as the protocol remains intact).</p>

<h4>has no dependencies</h4>
<p>A modern D2 dmd compiler is all you need.</p>

<h4>works with dub</h4>
<p>DUB support was recently added, making it even simpler to integrate TinyRedis into your code.</p>

<h4>makes working with Redis trivial.</h4>
<p>Nuff said. Instructions are below.</p>

<h2>Quick Example</h2>
<p>Without further ado : </p>
<pre><code language="dlang">
import tinyredis;
import std.stdio; 

void main()
{
    auto redis = new Redis("localhost", 6379);
    redis.send("SET", "name", "Adil");
    writeln("The name's ", redis.send("GET name")); //The name's Adil
    
    //Add data to a set and read it
    redis.send("SADD", "fruits", ["apples", "oranges", "bananas"]);
    auto fruits = redis.send("SMEMBERS", "fruits");
    foreach(k, fruit; fruits) writeln(k, ") ", fruit);
    
    //Cast your results
    writefln("There are %s fruits", redis.send("SCARD", "fruits"));
    
    //intelligent opCasts for responses!
    if(redis.send("EXISTS", "fruits")) writeln("Fruits have been defined!");
    
    //Lua scripting is supported! ..
    Response r1 = redis.eval("return {KEYS[1],KEYS[2],ARGV[1],ARGV[2]}", ["key1", "key2"], ["first", "second"]);
    writeln(r1); // [key1, key2, first, second]
    
    // .. And pipelining
    redis.pipeline(["SET person1:name Adil", "SET person1:name Batman", "SET person1:name Robin"]);
    
    //.. And transactions
    redis.transaction(["SET ctr 0", "INCR ctr", "INCR ctr"]);
}
</code></pre>

<h2>Collections</h2>
<p>TinyRedis aims to create a series of OOP wrappers over Redis data structures. Currently, there is the <a href="https://github.com/adilbaig/Tiny-Redis/tree/master/source/tinyredis/collections">Set</a> class.</p>
<pre><code language="dlang">
import tinyredis;
import tinyredis.collections.set;

void main()
{
    auto conn = new Redis("localhost", 6379);
    auto set  = new Set(conn, "tinyRedisUnitTestSet");
    
    set = ["banana", "apple", "orange"]; // data can be assigned using opAssign
    set.put("grapes"); //the put() function appends a value
    assert(set.scard() == 4); // runs the SCARD command, presents a proper count of the set ON THE SERVER
    
    //opAssign resets the data
    set = ["guava", "pear"];
    assert(set.scard() == 2);
    
    set ~= "banana"; // implements opOpAssign so ~= appends data
    set ~= ["orange", "mango", "apple"];
    set -= "mango"; // Oops, not mango season!
    assert(set.count() == 5);
    
    import std.algorithm.searching : canFind;
    foreach (fruit; set.smembers())
    {
        assert(["guava", "pear", "banana", "apple", "orange"].canFind(fruit.toString));
    }
}
</code></pre>

<h2>PubSub</h2>
<p><a href="http://redis.io/topics/pubsub">PubSub</a> is a lightweight messaging solution built on top of Redis. It allows any Redis client to broadcast and receive messages in an asynchronous fashion. TinyRedis supports PubSub using the <a href="https://github.com/adilbaig/Tiny-Redis/blob/master/source/tinyredis/subscriber.d">Subscriber</a> class. See examples below : </p>
<pre><code language="dlang">
import tinyredis;
import tinyredis.subscriber;
import std.stdio; 
import std.socket;
import std.functional;

void main()
{
    auto redis = new Redis(); // client used for sending
    auto subscriber = new Subscriber();
    
    subscriber.subscribe("MYROOM",
        (channel, message) => writefln("Channel '%s': %s", channel, message));
    scope (exit) subscriber.unsubscribe("MYROOM");

    redis.send("PUBLISH", "MYROOM", "Hello RoomMates!");
    subscriber.processMessages();

    subscriber.psubscribe("news.*",
        (string pattern, string channel, string message) =>
            writefln("Channel '%s' (matching '%s'): %s", channel, pattern, message));
    scope(exit) subscriber.punsubscribe("news.*");

    redis.send("PUBLISH", "news.international", "International News");
    redis.send("PUBLISH", "news.domestic", "Something local");
    subscriber.processMessages();
}
</code></pre>

<h2>Documentation</h2>
<p>TinyRedis has a very shallow learning curve. You learn best by using it. The following links should help you get started.</p>
<ul>
    <li><a href="https://github.com/adilbaig/Tiny-Redis/blob/master/examples/example.d">Example.d</a> - This file is included in the source download. It gives an overview of a variety of examples of calling commands, pipelining, doing transactions and handling/printing/iterating over results.</li>
    <li><a href="https://github.com/adilbaig/Tiny-Redis/blob/master/examples/console.d">Console.d</a> - A simple redis-cli like console application. See some sample code for PubSub here.</li>
	<li><a href="https://github.com/adilbaig/Tiny-Redis/blob/master/source/tinyredis/redis.d">Primary documentation is the source</a></li>
	<li>You may also want to check out the unit tests in <a href="https://github.com/adilbaig/Tiny-Redis/tree/master/source/tinyredis">tinyredis/*</a> </li>
</ul>

<h2>Benchmarks</h2>
<p>Benchmarks are heavily dependent on your machine's hardware, <a href="http://man7.org/linux/man-pages/man2/getrlimit.2.html">Linux resource limits</a>, your Redis server version and whether you're running across a network. You may want to run the benchmarking program on your PC/Server to get a real feel for your speed.</p>
<p>Here are the results (after warm-up) from running the benchmarking program on a Ubuntu 14.04 x64 laptop. Intel core i5 4200M 2.5Ghz, 8GB DDR3 RAM</p>
<pre class="bash"><code>./benchmark -n100000
====== GET ======
100000 requests completed in 2.297 seconds
43535 requests per second

====== SET ======
100000 requests completed in 2.453 seconds
40766 requests per second
</code></pre>

For comparison, here are results on the same hardware with <a href="https://github.com/redis/hiredis">hiredis</a>, the official redis driver in C.
<pre class="bash"><code>redis-benchmark -c 1 -t get,set -n 100000
====== SET ======
  100000 requests completed in 2.85 seconds
  1 parallel clients
  3 bytes payload
  keep alive: 1

100.00% <= 2 milliseconds
100.00% <= 3 milliseconds
35124.70 requests per second

====== GET ======
  100000 requests completed in 2.77 seconds
  1 parallel clients
  3 bytes payload
  keep alive: 1

100.00% <= 1 milliseconds
100.00% <= 2 milliseconds
100.00% <= 4 milliseconds
36127.17 requests per second 
</code></pre>

<h2>Installation Instructions</h2>
<h4>Using Dub</h4>
<p>Instructions are on the <a href="http://code.dlang.org/packages/tinyredis">TinyRedis DUB page</a></p>

<h4>Using Source</h4>
<p>Download the <a href="https://github.com/adilbaig/Tiny-Redis/releases">latest release</a> and compile <code>source/tinyredis/*</code> with your source files. Ex:</p>
<pre><code>dmd YOUR_SOURCE.d source/tinyredis/*</code></pre>

<h2>Other programs</h2>
<p>A couple of sample programs are included, to demonstrate API usage. Before running any of them, <strong>ensure you have a Redis server running on "localhost:6379"</strong> (default Redis settings). Running these examples requires either <a href="https://en.wikipedia.org/wiki/Make_(software)">Make</a> or <a href="http://code.dlang.org/download">dub</a>.</p>

<h4>The Example Program</h4>
<p>This program is only useful when read as source. It demonstrates the API. Run:</p>
<pre><code>make example; // or 'dub --config=example;'</code></pre>
<p>The output is not interesting, look at the code.</p>

<h4>The Interactive Console</h4>
<p>The interactive console works like redis-cli. It is meant to show the simplicity of the driver, and is not a replacement for redis-cli. Run:</p>
<pre><code>make console; // or 'dub --config=console;'</code></pre>

<h4>The Benchmarking Program</h4>
<p>A simple benchmark is included. To see how redis performs on your PC/Server, Run:</p>
<pre><code>make benchmark; // or 'dub --config=benchmark;'</code></pre>

<h2>Unit Tests Included</h2>
<pre><code>make test; // or 'dub test'</code></pre>

<h2>Dependencies</h2>
<p>None, except a standard D2 compiler. Updated to work with DMD 2.071. Tested on Linux x64.</p>

<h2>Support and Feedback</h2>
<p>For feedback, bug reports or feature requests create a <b><a href="https://github.com/adilbaig/Tiny-Redis/issues">support ticket</a></b> on github. Feel free to suggest code improvements, new features or anything else. Thanks! </p>

<p>Adil Baig
<br>Blog : <a href="http://thoughtsimproved.wordpress.com">thoughtsimproved.wordpress.com</a>
<br>Twitter : <a href="http://twitter.com/aidezigns">@aidezigns</a></p>

  </section>
  <a id="forkme" href="https://github.com/adilbaig/Tiny-Redis">
  	<img src="images/github-banner.png" alt="fork TinyRedis on github">
  	</a>
</div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2082152-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>
